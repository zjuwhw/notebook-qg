?text
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_prime = pf
pf_prime = 1/2*(pm+pf)
return(pf_prime, pf_prime)
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pf = GetGeneFreq_sex_next(pf,pm)[1]
pm = GetGeneFreq_sex_next(pf,pm)[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_prime = pf
pf_prime = 1/2*(pm+pf)
return(c(pf_prime, pf_prime))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pf = GetGeneFreq_sex_next(pf,pm)[1]
pm = GetGeneFreq_sex_next(pf,pm)[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
data
library(reshape2)
melt(data)
?melt
melt(data,id.vars=gene)
melt(data,id.vars=
"gene")
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_prime = pf
pf_prime = 1/2*(pm+pf)
return(c(pf_prime, pf_prime))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pf = GetGeneFreq_sex_next(pf,pm)[1]
pm = GetGeneFreq_sex_next(pf,pm)[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value), colour=variable) + geom_line()
ggplot(data.melt, aes(x=gene, y=value), group = variable,colour=variable) + geom_line()
ggplot(data.melt, aes(x=gene, y=value), group = variable,colour=variable) + geom_point()
data.melt
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_point()
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line()
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_prime = pf
pf_prime = 1/2*(pm+pf)
return(c(pf_prime, pm_prime))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pf = GetGeneFreq_sex_next(pf,pm)[1]
pm = GetGeneFreq_sex_next(pf,pm)[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line()
data
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_next = pf
pf_next = 1/2*(pm+pf)
return(c(pf_next, pm_next))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
print(GetGeneFreq_sex_next(pf,pm))
pf = GetGeneFreq_sex_next(pf,pm)[1]
pm = GetGeneFreq_sex_next(pf,pm)[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
GetGeneFreq_sex_next(pf,pm)
GetGeneFreq_sex_next(pf,pm)[1]
GetGeneFreq_sex_next(pf,pm)[2]
pf = 1; pm = 0; gene=0
GetGeneFreq_sex_next(pf,pm)
GetGeneFreq_sex_next(pf,pm)[1]
GetGeneFreq_sex_next(pf,pm)[2]
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_next = pf
pf_next = 1/2*(pm+pf)
return(c(pf_next, pm_next))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pfm = GetGeneFreq_sex_next(pf,pm)
pf = pfm[1]; pm=pfm[2]
data = rbind(data, data.frame(gene=gene, pf=pf, pm=pm, p=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line()
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_next = pf
pf_next = 1/2*(pm+pf)
return(c(pf_next, pm_next))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pfm = GetGeneFreq_sex_next(pf,pm)
pf = pfm[1]; pm=pfm[2]
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line() +
ggtitle("Apprach to equilibrium under random mating for a sex-linked gene") +
xlab("Generation") +
ylab("Gene(allele) Frequency")
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_next = pf
pf_next = 1/2*(pm+pf)
return(c(pf_next, pm_next))
}
data = c()
pf = 0.6; pm = 0.3; gene=0
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pfm = GetGeneFreq_sex_next(pf,pm)
pf = pfm[1]; pm=pfm[2]
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line() +
ggtitle("Approach to equilibrium under random mating for a sex-linked gene") +
xlab("Generation") +
ylab("Gene(allele) Frequency")
GetGeneFreq_whole = function(pf, pm){
### We assume the number of males and females are equal in the population
return(2/3*pf + 1/3*pm)
}
GetGeneFreq_sex_next = function(pf,pm){
pm_next = pf
pf_next = 1/2*(pm+pf)
return(c(pf_next, pm_next))
}
data = c()
pf = 1; pm = 0; gene=0
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
for(gene in 1:10){
pfm = GetGeneFreq_sex_next(pf,pm)
pf = pfm[1]; pm=pfm[2]
data = rbind(data, data.frame(gene=gene, female=pf, male=pm, whole=GetGeneFreq_whole(pf,pm)))
}
library(ggplot2)
library(reshape2)
data.melt = melt(data, id.vars = "gene")
ggplot(data.melt, aes(x=gene, y=value,colour=variable), group = variable) + geom_line() +
ggtitle("Approach to equilibrium under random mating for a sex-linked gene") +
xlab("Generation") +
ylab("Gene(allele) Frequency")
rep(c(1,1),4)
matrix(rep(c(1,1),4),ncol=2)
rbind(matrix(rep(c(1,1),4),ncol=2),matrix(rep(c(1,0),4), ncol=2),matrix(rep(c(0,1),13),ncol=2),matrix(rep(c(0,0),26),ncol=2))
x = rbind(matrix(rep(c(1,1),4),ncol=2),matrix(rep(c(1,0),4), ncol=2),matrix(rep(c(0,1),13),ncol=2),matrix(rep(c(0,0),26),ncol=2))
lm(x[,1]~x[,2])
summary(lm(x[,1]~x[,2]))
0.13896^2
x = rbind(matrix(rep(c(1,1),4),ncol=2),matrix(rep(c(1,0),4), ncol=2),matrix(rep(c(0,1),13),ncol=2),matrix(rep(c(0,0),26),ncol=2))
x
cor(x[,1],x[,2])
cor(x[,1],x[,2])^2
summary(lm(x[,1]~x[,2]))
x = rbind(matrix(rep(c(1,1),4),ncol=2),matrix(rep(c(1,0),4), ncol=2),matrix(rep(c(0,1),13),ncol=2),matrix(rep(c(0,0),26),ncol=2))
ncol(x)
nrow(x)
colMeans(x)
colSums(x)
View(x)
View(x)
matrix(rep(c(1,0),4), ncol=2)
x = matrix(c(rep(c(1,1),4),rep(c(1,0),4), rep(c(0,1),13), rep(c(0,0),26)),ncol=2, byrow = TRUE)
x
cor(x[,1],x[,2])
cor(x[,1],x[,2])^2
summary(lm(x[,1]~x[,2]))
RowSums(x)
rowSums(x)
colSums(x)
colMeans(x)
qchisq(0.93,1)
pchisq(0.93,1)
1 - pchisq(0.93,1)
?pchisq
0.882^2
0.882^2
chisq.test(x=c(4,4,13,26),y=c(2.8,5.2,14.1,24.9))
x=c(4,4,13,26)
y=c(2.8,5.2,14.1,24.9)
x-y
(x-y)^2
(x-y)^2/y
sum((x-y)^2/y)
summary(chisq.test(x=c(4,4,13,26),y=c(2.8,5.2,14.1,24.9)))
pchisq(0.93,1)
1-pchisq(0.93,1)
(1-pchisq(0.93,1))*2
1-pchisq(0.93,1)
1-pchisq(0.93,2)
1-pchisq(0.93,3)
1-pchisq(0.93,4)
1-pchisq(0.93,5)
1-pchisq(19,2)
1-pchisq(0.93,2)
1-pchisq(0.93,1)
1-pchisq(0.93,1)
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t)
t = 0:12;d0 = 1
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t)
lines(t,d0*(1-0.1)^t)
lines(t,d0*(1-0.2)^t)
lines(t,d0*(1-0.3)^t)
lines(t,d0*(1-0.5)^t)
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="Generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t, col=1)
lines(t,d0*(1-0.1)^t, col=2)
lines(t,d0*(1-0.2)^t, col=3)
lines(t,d0*(1-0.3)^t, col=4)
lines(t,d0*(1-0.5)^t, col=5)
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="Generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t, col=1);text(10,0.7,"0.05")
lines(t,d0*(1-0.1)^t, col=2);text(9,0.5,"0.1")
lines(t,d0*(1-0.2)^t, col=3);text(7,0.3,"0.2")
lines(t,d0*(1-0.3)^t, col=4);text(6.5,0.2,"0.3")
lines(t,d0*(1-0.5)^t, col=5);text(4.5,0.1,"0.5")
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="Generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t, col=1);text(10,0.7,"0.05")
lines(t,d0*(1-0.1)^t, col=2);text(9,0.47,"0.1")
lines(t,d0*(1-0.2)^t, col=3);text(7,0.3,"0.2")
lines(t,d0*(1-0.3)^t, col=4);text(6.5,0.15,"0.3")
lines(t,d0*(1-0.5)^t, col=5);text(4.5,0.1,"0.5")
plot(c(0,12),c(0,1),col="white",main="Approach to equilibrium under random mating of two loci, considered jointly.",xlab="Generation", ylab="D")
t = 0:12;d0 = 1
lines(t,d0*(1-0.05)^t, col=1);text(10,0.7,"0.05")
lines(t,d0*(1-0.1)^t, col=2);text(9,0.47,"0.1")
lines(t,d0*(1-0.2)^t, col=3);text(7,0.3,"0.2")
lines(t,d0*(1-0.3)^t, col=4);text(6,0.2,"0.3")
lines(t,d0*(1-0.5)^t, col=5);text(4.5,0.1,"0.5")
